<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <title>fetch无法携带用户登陆session（cookie）的问题</title> <meta name="description" content="fetch无法携带用户登陆session（cookie）的问题"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="/jekyll/update/2017/01/04/fetch%E6%97%A0%E6%B3%95%E6%90%BA%E5%B8%A6%E7%94%A8%E6%88%B7%E7%99%BB%E9%99%86session-cookie-%E7%9A%84%E9%97%AE%E9%A2%98.html"> <link rel="alternate" type="application/rss+xml" title="" href="/feed.xml"> <script src="/assets/js/modernizr.js"></script> </head> <body"> <main class="wrapper"> <header class="site-header"> <a href="#navbar" id="menu-burger" class="menu-burger">Menu <span class="nav-icon"></span> <svg x="0px" y="0px" width="54px" height="54px" viewBox="0 0 54 54"> <circle fill="transparent" stroke="#000000" stroke-width="1" cx="27" cy="27" r="25" stroke-dasharray="157 157" stroke-dashoffset="157"></circle> </svg> </a> <div id="navbar" class="navbar"> <div class="navigation-wrapper"> <div class="half-block"> <h2>Navigation</h2> <nav> <ul class="primary-nav"> <li><a href="/">Home</a></li> <li><a href="/blog">Blog</a></li> <li><a href="/about">About</a></li> <li><a href="https://github.com/answershuto" ><i class="icon icon-github"></i> Github</a></li> </ul> </nav> </div> </div> </div> </header> <article class="post" itemscope itemtype="http://schema.org/BlogPosting"> <header class="post-header intro"> <div class="intro-in"> <h1 class="post-title" itemprop="name headline">fetch无法携带用户登陆session（cookie）的问题</h1> <p class="post-meta"><time datetime="2017-01-04T20:52:00+08:00" itemprop="datePublished">Jan 4, 2017</time></p> </div> </header> <div class="post-content container" itemprop="articleBody"> <h1 id="fetchsessioncookie">fetch无法携带用户登陆session（cookie）的问题</h1> <p>第一次用fetch模块来操作ajax请求，在写登陆交互的时候遇到了这个问题。</p> <p>登陆成功以后服务端用setcookie的方法为客户端设置了session回话(即cookie)。但是第二个请求发过去服务端却返回了没有登陆的信息，即登陆状态异常。</p> <p>排查了服务端代码以后发现没有问题。在客户端用jquery的$.ajax尝试以后发现能正常得到session并在第二个请求中携带session，服务端正常响应，确定是客户端的问题而且是fetch模块的问题。</p> <p>查看文档以后解决了该问题。</p> <p>详细可以查看fetch文档。</p> <p><a href="https://github.com/github/fetch/blob/c23c3f9b3aa3e2bcc8853cc0b1b08830068e6163/README.md#sending-cookies">https://github.com/github/fetch/blob/c23c3f9b3aa3e2bcc8853cc0b1b08830068e6163/README.md#sending-cookies</a></p> <blockquote> <p><img src="/img/fetch/fetch.png" alt="img" /></p> </blockquote> <p>必须设置credentials参数才能自动发送当前域的cookie。</p> </div> </article> <footer class="site-footer"> <div class="container"> <ul class="social"> <li><a href="http://github.com/answershuto" target="_blank"><i class="icon icon-github"></i></a></li> </ul> <p> <br><small>&copy;2017 CaoYang , All rights reserved.</small> </p> </div> </footer> </main> <script src="/assets/js/jquery-2.1.1.js"></script> <script src="/assets/js/main.js"></script> </body> </html><!-- by nandomoreira.me -->